# Статус подключения к MT5

## Текущее состояние

### ✅ Что работает:
- Приложение успешно запускается на macOS
- LogicManager инициализирован
- MT5Service настроен для работы через Flask API
- База данных подключена
- Все сервисы инициализированы

### ❌ Что не работает:
- **Flask сервер недоступен** на `http://10.211.55.3:5000`
- MT5 не может подключиться к данным

## Причина проблемы

Приложение на macOS пытается подключиться к MT5 через Flask API сервер, который должен быть запущен на Windows машине с IP `10.211.55.3:5000`.

## Решение

### 1. Запуск Flask сервера на Windows

На Windows машине (IP: 10.211.55.3) выполните:

```bash
# 1. Перейдите в папку проекта
cd /path/to/MT5_Project

# 2. Установите зависимости (если не установлены)
pip install flask MetaTrader5

# 3. Запустите Flask сервер
python mt5_server.py
```

### 2. Проверка подключения

После запуска сервера на Windows, проверьте подключение с macOS:

```bash
# На macOS
python test_flask_connection.py
```

### 3. Настройка файрвола

Убедитесь, что порт 5000 открыт на Windows:

```cmd
# На Windows (от администратора)
netsh advfirewall firewall add rule name="MT5 Flask Server" dir=in action=allow protocol=TCP localport=5000
```

### 4. Проверка сетевого подключения

На macOS проверьте доступность сервера:

```bash
# Проверка ping
ping 10.211.55.3

# Проверка порта
nc -zv 10.211.55.3 5000

# Проверка HTTP
curl http://10.211.55.3:5000/health
```

## Тестирование подключения

После запуска сервера на Windows, приложение на macOS должно:

1. ✅ Подключиться к Flask серверу
2. ✅ Получить информацию об аккаунте MT5
3. ✅ Получить открытые позиции
4. ✅ Отправлять ордера через API

## Логи для диагностики

При запуске приложения на macOS вы должны увидеть:
```
✅ MT5 автоматически подключен: MT5 connected via Flask API
```

Вместо:
```
⚠️ MT5 не подключен: Flask сервер недоступен: 403
```

## Следующие шаги

1. **Запустите Flask сервер на Windows машине**
2. **Откройте порт 5000 в файрволе Windows**
3. **Проверьте подключение с macOS**
4. **Перезапустите приложение на macOS**

## Обновленные настройки

Все файлы обновлены с правильным IP адресом:
- `data/config.json` - `http://10.211.55.3:5000`
- `test_flask_connection.py` - `http://10.211.55.3:5000`
- `utils/cursor_send_order_improved.py` - `http://10.211.55.3:5000` 